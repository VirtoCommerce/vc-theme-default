{% unless current_collection %}
    {% assign current_collection = collection %}
{% endunless %}

{% assign on_sale = false %}
{% if product.compare_at_price.amount > product.price.actual_price.amount %}
    {% assign on_sale = true %}

{% endif %}

{% assign unavailable = false %}
{% assign sold_out = false %}

{% if product.buyable and product.in_stock != true %}
    {% assign sold_out = true %}
{% endif %}

{% if product.buyable != true  %}
    {% assign unavailable = true %}
{% endif %}

{% assign image_size = settings.collection_prod_image_sizes %}
<div class="grid-item{% if unavailable %} unavailable{% endif %}{% if sold_out %} sold-out{% endif %}{% if on_sale %} on-sale{% endif %}">
    <a href="{{ product.url | within: current_collection }}" class="product-grid-item product-list-item">
        <div class="grid">            
            {% for block in section.blocks %}
                {% include block.type section: section, block: block %}
            {% endfor %}            
        </div>
    </a>
</div>
